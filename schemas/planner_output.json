{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "PlannerOutput",
  "description": "Schema for A01 Planner agent output",
  "type": "object",
  "required": ["agent", "status", "tasks"],
  "properties": {
    "agent": {
      "type": "string",
      "const": "A01",
      "description": "Agent identifier"
    },
    "status": {
      "type": "string",
      "enum": ["success", "partial", "failed", "needs_clarification"],
      "description": "Planning status"
    },
    "summary": {
      "type": "string",
      "maxLength": 1000,
      "description": "High-level summary of the plan"
    },
    "tasks": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["id", "title", "description", "acceptance_criteria", "priority"],
        "properties": {
          "id": {
            "type": "string",
            "pattern": "^task-[0-9]+$",
            "description": "Unique task identifier"
          },
          "title": {
            "type": "string",
            "minLength": 5,
            "maxLength": 100
          },
          "description": {
            "type": "string",
            "minLength": 20,
            "maxLength": 2000
          },
          "acceptance_criteria": {
            "type": "array",
            "minItems": 1,
            "items": { "type": "string" }
          },
          "priority": {
            "type": "string",
            "enum": ["critical", "high", "medium", "low"]
          },
          "estimated_complexity": {
            "type": "string",
            "enum": ["trivial", "simple", "moderate", "complex", "very_complex"]
          },
          "dependencies": {
            "type": "array",
            "items": {
              "type": "string",
              "pattern": "^task-[0-9]+$"
            },
            "description": "Task IDs this task depends on"
          },
          "assigned_agent": {
            "type": "string",
            "enum": ["A03", "A04", "A05", "A06", "A10", "A11", "A12"],
            "description": "Recommended agent for implementation"
          },
          "files_to_create": {
            "type": "array",
            "items": { "type": "string" }
          },
          "files_to_modify": {
            "type": "array",
            "items": { "type": "string" }
          },
          "test_files": {
            "type": "array",
            "items": { "type": "string" },
            "description": "Test files for TDD validation"
          },
          "tags": {
            "type": "array",
            "items": { "type": "string" }
          }
        }
      },
      "description": "List of tasks to implement"
    },
    "milestones": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["id", "name", "task_ids"],
        "properties": {
          "id": { "type": "string" },
          "name": { "type": "string" },
          "description": { "type": "string" },
          "task_ids": {
            "type": "array",
            "items": { "type": "string" }
          }
        }
      },
      "description": "Optional grouping of tasks into milestones"
    },
    "risks": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "description": { "type": "string" },
          "severity": {
            "type": "string",
            "enum": ["low", "medium", "high"]
          },
          "mitigation": { "type": "string" }
        }
      }
    },
    "assumptions": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Assumptions made during planning"
    },
    "clarification_needed": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "question": { "type": "string" },
          "context": { "type": "string" },
          "options": {
            "type": "array",
            "items": { "type": "string" }
          }
        }
      },
      "description": "Questions that need human clarification"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time"
    }
  }
}
