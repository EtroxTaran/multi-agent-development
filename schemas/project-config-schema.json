{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://meta-architect.dev/schemas/project-config.json",
  "title": "Project Configuration",
  "description": "Configuration schema for meta-architect project settings",
  "type": "object",
  "properties": {
    "project_name": {
      "type": "string",
      "description": "Name of the project"
    },
    "created_at": {
      "type": "string",
      "description": "ISO timestamp when project was created",
      "format": "date-time"
    },
    "validation": {
      "type": "object",
      "description": "Validation threshold settings",
      "properties": {
        "validation_threshold": {
          "type": "number",
          "description": "Minimum score for Phase 2 validation (0-10)",
          "minimum": 0,
          "maximum": 10,
          "default": 6.0
        },
        "verification_threshold": {
          "type": "number",
          "description": "Minimum score for Phase 4 verification (0-10)",
          "minimum": 0,
          "maximum": 10,
          "default": 7.0
        },
        "max_phase_retries": {
          "type": "integer",
          "description": "Maximum retries per phase before escalation",
          "minimum": 1,
          "maximum": 10,
          "default": 3
        }
      },
      "additionalProperties": false
    },
    "quality": {
      "type": "object",
      "description": "Code quality settings",
      "properties": {
        "coverage_threshold": {
          "type": "number",
          "description": "Minimum test coverage percentage (0-100)",
          "minimum": 0,
          "maximum": 100,
          "default": 70
        },
        "coverage_blocking": {
          "type": "boolean",
          "description": "Whether failing coverage threshold blocks the workflow",
          "default": false
        },
        "build_required": {
          "type": "boolean",
          "description": "Whether build must succeed before verification",
          "default": true
        },
        "lint_required": {
          "type": "boolean",
          "description": "Whether linting must pass before verification",
          "default": false
        }
      },
      "additionalProperties": false
    },
    "security": {
      "type": "object",
      "description": "Security scanning settings",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Whether security scanning is enabled",
          "default": true
        },
        "blocking_severities": {
          "type": "array",
          "description": "Severities that block workflow completion",
          "items": {
            "type": "string",
            "enum": ["critical", "high", "medium", "low", "info"]
          },
          "default": ["critical", "high"],
          "uniqueItems": true
        }
      },
      "additionalProperties": false
    },
    "task_size_limits": {
      "type": "object",
      "description": "Task granularity limits (tasks exceeding limits are auto-split)",
      "properties": {
        "max_files_to_create": {
          "type": "integer",
          "description": "Maximum files a single task can create",
          "minimum": 1,
          "maximum": 20,
          "default": 3
        },
        "max_files_to_modify": {
          "type": "integer",
          "description": "Maximum files a single task can modify",
          "minimum": 1,
          "maximum": 20,
          "default": 5
        },
        "max_criteria_per_task": {
          "type": "integer",
          "description": "Maximum acceptance criteria per task",
          "minimum": 1,
          "maximum": 20,
          "default": 5
        },
        "max_estimated_tokens": {
          "type": "integer",
          "description": "Maximum estimated context tokens per task",
          "minimum": 1000,
          "maximum": 200000,
          "default": 50000
        },
        "auto_split": {
          "type": "boolean",
          "description": "Automatically split tasks exceeding limits",
          "default": true
        }
      },
      "additionalProperties": false
    },
    "workflow": {
      "type": "object",
      "description": "Workflow behavior settings",
      "properties": {
        "features": {
          "type": "object",
          "description": "Feature flags for optional workflow nodes",
          "properties": {
            "product_validation": {
              "type": "boolean",
              "description": "Enable PRODUCT.md validation",
              "default": true
            },
            "environment_check": {
              "type": "boolean",
              "description": "Enable pre-implementation environment checks",
              "default": true
            },
            "build_verification": {
              "type": "boolean",
              "description": "Enable post-implementation build verification",
              "default": true
            },
            "coverage_check": {
              "type": "boolean",
              "description": "Enable test coverage checking",
              "default": true
            },
            "security_scan": {
              "type": "boolean",
              "description": "Enable security vulnerability scanning",
              "default": true
            },
            "approval_gates": {
              "type": "boolean",
              "description": "Enable human approval gates at specified phases",
              "default": false
            }
          },
          "additionalProperties": false
        },
        "approval_phases": {
          "type": "array",
          "description": "Phase numbers requiring human approval (when approval_gates is true)",
          "items": {
            "type": "integer",
            "minimum": 1,
            "maximum": 5
          },
          "default": [],
          "uniqueItems": true
        },
        "parallel_workers": {
          "type": "integer",
          "description": "Maximum parallel workers for task implementation",
          "minimum": 1,
          "maximum": 10,
          "default": 1
        },
        "review_gating": {
          "type": "string",
          "description": "Review gating policy for verification (docs-only skip)",
          "enum": ["conservative", "disabled"],
          "default": "conservative"
        }
      },
      "additionalProperties": false
    },
    "integrations": {
      "type": "object",
      "description": "External integration settings",
      "properties": {
        "linear": {
          "type": "object",
          "description": "Linear issue tracking integration",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "Enable Linear integration",
              "default": false
            },
            "team_id": {
              "type": "string",
              "description": "Linear team ID for issue creation"
            },
            "create_project": {
              "type": "boolean",
              "description": "Create a Linear project for the feature",
              "default": true
            },
            "project_id": {
              "type": "string",
              "description": "Existing Linear project ID to use"
            },
            "status_mapping": {
              "type": "object",
              "description": "Map task status to Linear workflow states",
              "properties": {
                "pending": {
                  "type": "string",
                  "default": "Backlog"
                },
                "in_progress": {
                  "type": "string",
                  "default": "In Progress"
                },
                "completed": {
                  "type": "string",
                  "default": "Done"
                },
                "blocked": {
                  "type": "string",
                  "default": "Blocked"
                },
                "failed": {
                  "type": "string",
                  "default": "Cancelled"
                }
              },
              "additionalProperties": true
            }
          },
          "additionalProperties": false
        },
        "task_tracking": {
          "type": "object",
          "description": "Local markdown task tracking",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "Enable local markdown task files",
              "default": true
            },
            "tasks_dir": {
              "type": "string",
              "description": "Directory for task files (relative to .workflow/)",
              "default": "tasks"
            },
            "make_readonly": {
              "type": "boolean",
              "description": "Make task files read-only (chmod 444)",
              "default": true
            },
            "validate_checksums": {
              "type": "boolean",
              "description": "Validate task file checksums on read",
              "default": true
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": true,
  "examples": [
    {
      "project_name": "my-feature",
      "created_at": "2026-01-21T10:00:00Z",
      "validation": {
        "validation_threshold": 7.0,
        "verification_threshold": 8.0
      },
      "quality": {
        "coverage_threshold": 85,
        "coverage_blocking": true
      },
      "security": {
        "enabled": true,
        "blocking_severities": ["critical", "high"]
      },
      "workflow": {
        "features": {
          "product_validation": true,
          "environment_check": true,
          "build_verification": true,
          "coverage_check": true,
          "security_scan": true,
          "approval_gates": false
        }
      }
    }
  ]
}
